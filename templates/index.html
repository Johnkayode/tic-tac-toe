<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe</title>
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js" integrity="sha384-c79GN5VsunZvi+Q/WObgk2in0CbZsHnjEqvFxC5DxHn9lTfNce2WW6h2pH6u/kF+" crossorigin="anonymous"></script>
</head>
<body>
    <style>
        body {
            background: #222222;
            padding: auto;
        }
        #board {
            margin: 40px auto;
            width: 450px;
        }
        #board button {
            height: 150px;
            width: 150px;
            float: left;
            font-size: 2.5rem;
            cursor: pointer;
        }
        #board button:focus{
            border: none;
            outline: none;
        }
    </style>
    <section>
        <h3>Create Game</h3>
        <input placeholder="Enter username">
        <button id="startGame">Start Game</button>
    </section>
    <section id="board" hidden>
        <button id="r1c1">X</button><button id="r1c2"></button><button id="r1c3"></button>
        <button id="r2c1">O</button><button id="r2c2">X</button><button id="r2c3">O</button>
        <button id="r3c1">X</button><button id="r3c2">O</button><button id="r3c3">O</button>
    </section>

    <script>
        const socket = io('http://localhost:3000');
        
        socket.on('connect', () => {
            console.log('Connected to server!');
            // Additional code to run after the connection is established
        });

        let gameId = "";

        function createGame(username){
            socket.emit('createGame', { username: username } );
        }

        function joinGame(){
            let username = document.getElementById('username').value;
            let gameId = document.getElementById('gameId').value;
            socket.emit('joinGame', { username: username, gameId: gameId })
        }

        socket.on('gameCreated', (data) => {
            gameId = data.gameId;
            console.log(`Game created with code: ${gameId}`);
        });

        socket.on('gameJoined', (data) => {
            username = data.username
            gameId = data.gameId;
            console.log(`${username} joined game with code: ${gameId}`);
        });

        socket.on('invalidGame', () => {
            console.log('Invalid game code');
        });

        socket.on('moveMade', (data) => {
            // Handle the move on the Tic-Tac-Toe board
            console.log(`Move made: ${JSON.stringify(data)}`);
        });

        // Example: Handle button click to make a move
        document.getElementById('startGame').addEventListener('click', (event) => {
                let username = "nerdthejohn";
                createGame(username)
                
            }
        );

        document.getElementById('board').addEventListener('click', (event) => {
            if (event.target.tagName === 'BUTTON') {
                const cellId = event.target.id;
                socket.emit('makeMove', { gameId, cellId });
                console.log(cellId);
                
            }
        });

        
    </script>
</body>
</html>